<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>تسجيل بيانات مرضى العيون</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
  <div class="container">
    <h1><i class="fas fa-eye"></i> تسجيل بيانات مرضى العيون</h1>
    <form id="eye-form">
      <!-- رقم تسلسلي -->
      <label for="patient-id">رقم تسلسلي:</label>
      <input type="text" id="patient-id" name="patient-id" readonly>

      <!-- معلومات عامة -->
      <label for="name">اسم المريض:</label>
      <input type="text" id="name" name="name" required>

      <label for="phone">رقم الهاتف:</label>
      <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" placeholder="1234567890" required>

      <label for="age">العمر:</label>
      <input type="number" id="age" name="age" min="0" required>

      <label for="gender">الجنس:</label>
      <select id="gender" name="gender">
        <option value="male">ذكر</option>
        <option value="female">أنثى</option>
      </select>

      <label for="date">التاريخ:</label>
      <input type="date" id="date" name="date" required>

      <label for="next-visit">تاريخ الزيارة المقبلة:</label>
      <input type="date" id="next-visit" name="next-visit">

      <!-- تفاصيل العين اليمنى -->
      <h3><i class="fas fa-eye"></i> العين اليمنى</h3>
      <label for="right-spherical">القيم الكروية (Spherical):</label>
      <select id="right-spherical" name="right-spherical">
        <script>
          for (let i = -20; i <= 20; i += 0.25) {
            document.write(<option value="${i.toFixed(2)}">${i.toFixed(2)}</option>);
          }
        </script>
      </select>

      <label for="right-astigmatism">الاستجماتيزم (Astigmatism):</label>
      <select id="right-astigmatism" name="right-astigmatism">
        <script>
          for (let i = -20; i <= 20; i += 0.25) {
            document.write(<option value="${i.toFixed(2)}">${i.toFixed(2)}</option>);
          }
        </script>
      </select>

      <label for="right-axis">المحور (Axis):</label>
      <select id="right-axis" name="right-axis">
        <script>
          for (let i = 0; i <= 180; i++) {
            document.write(<option value="${i}">${i}</option>);
          }
        </script>
      </select>

      <!-- تفاصيل العين اليسرى -->
      <h3><i class="fas fa-eye"></i> العين اليسرى</h3>
      <label for="left-spherical">القيم الكروية (Spherical):</label>
      <select id="left-spherical" name="left-spherical">
        <script>
          for (let i = -20; i <= 20; i += 0.25) {
            document.write(<option value="${i.toFixed(2)}">${i.toFixed(2)}</option>);
          }
        </script>
      </select>

      <label for="left-astigmatism">الاستجماتيزم (Astigmatism):</label>
      <select id="left-astigmatism" name="left-astigmatism">
        <script>
          for (let i = -20; i <= 20; i += 0.25) {
            document.write(<option value="${i.toFixed(2)}">${i.toFixed(2)}</option>);
          }
        </script>
      </select>

      <label for="left-axis">المحور (Axis):</label>
      <select id="left-axis" name="left-axis">
        <script>
          for (let i = 0; i <= 180; i++) {
            document.write(<option value="${i}">${i}</option>);
          }
        </script>
      </select>

      <label for="notes">ملاحظات إضافية:</label>
      <textarea id="notes" name="notes"></textarea>

      <!-- أزرار -->
      <button type="button" onclick="saveData()">حفظ البيانات</button>
      <button type="button" onclick="exportToExcel()">تصدير إلى Excel</button>
      <button type="button" onclick="printForm()">طباعة الاستمارة</button>
      <button type="button" onclick="shareForm()">مشاركة الاستمارة</button>
    </form>
    <!-- جدول عرض البيانات -->
    <h2><i class="fas fa-database"></i> البيانات المسجلة:</h2>
    <input type="text" id="search" placeholder="بحث بالاسم أو الأشهر..." oninput="searchData()">
    <table id="data-table">
      <thead>
        <tr>
          <th>الرقم التسلسلي</th>
          <th>اسم المريض</th>
          <th>رقم الهاتف</th>
          <th>العمر</th>
          <th>الجنس</th>
          <th>التاريخ</th>
          <th>القيم الكروية اليمنى</th>
          <th>الاستجماتيزم اليمنى</th>
          <th>المحور اليمنى</th>
          <th>القيم الكروية اليسرى</th>
          <th>الاستجماتيزم اليسرى</th>
          <th>المحور اليسرى</th>
          <th>تاريخ الزيارة المقبلة</th>
          <th>ملاحظات</th>
        </tr>
      </thead>
      <tbody>
        <!-- البيانات المضافة ستظهر هنا -->
      </tbody>
    </table>
  </div>

  <!-- مكتبة SheetJS لتصدير البيانات -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>